# üìÑ **PostgreSQL Local Benchmark Report (plain / part / idx / idx_part)**

## üìå 1. Batch Insert Performance

### Round 1 (0 ‚Üí 5M rows)

| Variant | Time (s) | Rows/sec |
|--------|----------|----------|
| **plain** | 176.9 | **28‚ÄØ270** |
| **part** | 323.2 | 15‚ÄØ472 |
| **idx** | n/a | ‚Äî |
| **idx_part** | n/a | ‚Äî |

### Round 2 (5M ‚Üí 10M rows)

| Variant | Time (s) | Rows/sec |
|--------|----------|----------|
| **plain** | 552.3 | **9‚ÄØ054** |
| **part** | 882.9 | 5‚ÄØ663 |
| **idx** | n/a | ‚Äî |
| **idx_part** | n/a | ‚Äî |

### üìù –í—ã–≤–æ–¥—ã –ø–æ –≤—Å—Ç–∞–≤–∫–µ
- **plain** ‚Äî —Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –≤—Å—Ç–∞–≤–∫–∏ (–Ω–µ—Ç –∏–Ω–¥–µ–∫—Å–æ–≤, –Ω–µ—Ç –ø–∞—Ä—Ç–∏—Ü–∏–π).  
- **part** ‚Äî –≤—Å—Ç–∞–≤–∫–∞ –ø–æ—á—Ç–∏ –≤ 2 —Ä–∞–∑–∞ –º–µ–¥–ª–µ–Ω–Ω–µ–µ plain.  
- **idx / idx_part** ‚Äî –∏–Ω–¥–µ–∫—Å—ã —Å–∏–ª—å–Ω–æ –∑–∞–º–µ–¥–ª—è—é—Ç –≤—Å—Ç–∞–≤–∫—É (–≤—Ä–µ–º—è –Ω–µ –≤—ã–≤–æ–¥–∏–ª–æ—Å—å, –Ω–æ –æ—á–µ–≤–∏–¥–Ω–æ).  
- –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ **–∑–∞–º–µ—Ç–Ω–æ —É—Ö—É–¥—à–∞–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å –≤—Å—Ç–∞–≤–∫–∏**, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–∞—Ö.

---

## üìå 2. Read Benchmark (by `accounted_for_bs_profile_id`)

### 5M rows

| Variant | Min (ms) | Avg (ms) | Median (ms) |
|--------|----------|----------|-------------|
| **plain** | 3475 | 3809 | 3760 |
| **part** | **2.21** | **6.59** | **5.05** |
| **idx** | **1.61** | **2.05** | **1.92** |
| **idx_part** | **1.68** | **2.13** | **1.94** |

### 10M rows

| Variant | Min (ms) | Avg (ms) | Median (ms) |
|--------|----------|----------|-------------|
| **plain** | 7718 | 8178 | 8127 |
| **part** | **2.00** | **12.87** | **6.59** |
| **idx** | **1.88** | **2.54** | **2.34** |
| **idx_part** | **1.50** | **1.81** | **1.66** |

### üìù –í—ã–≤–æ–¥—ã –ø–æ —á—Ç–µ–Ω–∏—é
- **plain** ‚Äî –∫—Ä–∞–π–Ω–µ –º–µ–¥–ª–µ–Ω–Ω–æ (–ø–æ–ª–Ω—ã–π seq scan).  
- **part** ‚Äî –æ–≥—Ä–æ–º–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à (–≤ —Å–æ—Ç–Ω–∏ —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ plain).  
- **idx** ‚Äî –±—ã—Å—Ç—Ä–µ–µ part.  
- **idx_part** ‚Äî **—Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π –≤–∞—Ä–∏–∞–Ω—Ç**.

---

## üìå 3. Query Benchmark (10 queries, 10M rows)

### –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (Avg, ms)

| Query | plain | part | idx | idx_part |
|-------|-------|-------|------|-----------|
| 1. –°–ø–∏—Å–∞–Ω–∏—è –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç—É | 8566 | **25** | **13** | **13** |
| 2. –ü–∞–≥–∏–Ω–∞—Ü–∏—è –ø–æ –ø—Ä–æ—Ñ–∏–ª—é | 8019 | **12** | **2.8** | **2.8** |
| 3. –ë–µ–∑ –æ—Ç–º–µ–Ω—ë–Ω–Ω—ã—Ö | 8350 | **11.5** | **1.95** | **1.87** |
| 4. –ü–æ bs_profile_id | 8121 | **16107** | **9242** | **13845** |
| 5. –ü—Ä–æ—Ñ–∏–ª—å + —Ç–∏–ø –±–æ–Ω—É—Å–∞ | 8248 | **59** | **1.96** | **1.99** |
| 6. –î–µ–π—Å—Ç–≤—É—é—â–∏–µ –ø–æ –¥–∞—Ç–µ | 8026 | **11.8** | **1.72** | **1.91** |
| 7. GROUP BY bs_quota_id | 8273 | **17695** | **9108** | **16999** |
| 8. –ü–æ –¥–æ–∫—É–º–µ–Ω—Ç—É (registrar) | 7867 | **10633** | **8439** | **10133** |
| 9. –û–±—â–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è | 7982 | **9720** | **8800** | **9387** |
| 10. –ü–æ id | **4.34** | **6.40** | **2.10** | **8.55** |

### üìù –í—ã–≤–æ–¥—ã –ø–æ –∑–∞–ø—Ä–æ—Å–∞–º
- **plain** ‚Äî –≤—Å–µ–≥–¥–∞ —Ö—É–¥—à–∏–π.  
- **idx** ‚Äî –ª—É—á—à–∏–π –ø–æ—á—Ç–∏ –≤–æ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.  
- **part** ‚Äî –æ—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤, —Ñ–∏–ª—å—Ç—Ä—É—é—â–∏—Ö –ø–æ –∫–ª—é—á—É –ø–∞—Ä—Ç–∏—Ü–∏–∏.  
- **part / idx_part** ‚Äî **–æ—á–µ–Ω—å –ø–ª–æ—Ö–æ** –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –æ–±—Ö–æ–¥–∞ –≤—Å–µ—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π (GROUP BY, –∞–≥—Ä–µ–≥–∞—Ç—ã, —Å–∫–∞–Ω—ã).  
- **idx_part** ‚Äî —Å–æ—á–µ—Ç–∞–µ—Ç –ø–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã:  
  - –±—ã—Å—Ç—Ä—ã–µ point‚Äëlookup  
  - –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, —Ç—Ä–µ–±—É—é—â–∏–µ –æ–±—Ö–æ–¥–∞ –≤—Å–µ—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π  

---

# üìå 4. –ò—Ç–æ–≥–æ–≤—ã–µ –≤—ã–≤–æ–¥—ã

## üü¢ plain (–±–µ–∑ –∏–Ω–¥–µ–∫—Å–æ–≤, –±–µ–∑ –ø–∞—Ä—Ç–∏—Ü–∏–π)
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –≤—Å—Ç–∞–≤–∫–∏.  
- –•—É–¥—à–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è.  
- –ü–æ–¥—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è write‚Äëheavy —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.

## üü° part (64 –ø–∞—Ä—Ç–∏—Ü–∏–∏)
- –í—Å—Ç–∞–≤–∫–∞ –º–µ–¥–ª–µ–Ω–Ω–µ–µ plain.  
- –ß—Ç–µ–Ω–∏–µ –ø–æ –∫–ª—é—á—É –ø–∞—Ä—Ç–∏—Ü–∏–∏ ‚Äî **–æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ**.  
- –ó–∞–ø—Ä–æ—Å—ã, —Ç—Ä–µ–±—É—é—â–∏–µ –æ–±—Ö–æ–¥–∞ –≤—Å–µ—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π ‚Äî **–æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ**.  
- –•–æ—Ä–æ—à–æ, –µ—Å–ª–∏ **–≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Ñ–∏–ª—å—Ç—Ä—É—é—Ç –ø–æ –∫–ª—é—á—É –ø–∞—Ä—Ç–∏—Ü–∏–∏**.

## üü¢ idx (–∏–Ω–¥–µ–∫—Å)
- –õ—É—á—à–∏–π –±–∞–ª–∞–Ω—Å.  
- –ë—ã—Å—Ç—Ä–æ–µ —á—Ç–µ–Ω–∏–µ –ø–æ—á—Ç–∏ –≤–æ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö.  
- –í—Å—Ç–∞–≤–∫–∞ –∑–∞–º–µ–¥–ª—è–µ—Ç—Å—è, –Ω–æ —É–º–µ—Ä–µ–Ω–Ω–æ.  
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç.

## üü° idx_part (–∏–Ω–¥–µ–∫—Å + –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)
- –°–∞–º—ã–µ –±—ã—Å—Ç—Ä—ã–µ point‚Äëlookup.  
- –ù–æ –∑–∞–ø—Ä–æ—Å—ã, —Ç—Ä–µ–±—É—é—â–∏–µ –æ–±—Ö–æ–¥–∞ –≤—Å–µ—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π, ‚Äî **—Ö—É–∂–µ, —á–µ–º –ø—Ä–æ—Å—Ç–æ idx**.  
- –ü–æ–¥—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ **99% –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Äî –ø–æ –∫–ª—é—á—É –ø–∞—Ä—Ç–∏—Ü–∏–∏**.

---

# PostgreSQL vs Trino+PostgreSQL:
# Benchmark Comparison: PostgreSQL vs Trino  
## Table variant: **idx**  
## Rows: 5M ‚Üí 10M  
## Tests: read benchmark, 10‚Äëquery suite

---

# 1. Read Benchmark (by accounted_for_bs_profile_id)

## 5M rows (PostgreSQL)

| Min (ms) | Max (ms) | Avg (ms) | Median (ms) |
|----------|----------|----------|-------------|
| 1.61 | 10.49 | **2.05** | 1.92 |

## 10M rows (PostgreSQL)

| Min (ms) | Max (ms) | Avg (ms) | Median (ms) |
|----------|----------|----------|-------------|
| 1.88 | 15.30 | **2.54** | 2.34 |

## 11M rows (Trino)

| Min (ms) | Max (ms) | Avg (ms) | Median (ms) |
|----------|----------|----------|-------------|
| 113.44 | 175.84 | **122.83** | 118.37 |

### –í—ã–≤–æ–¥—ã –ø–æ —á—Ç–µ–Ω–∏—é
- PostgreSQL: **2‚Äì3 ms**  
- Trino: **120‚Äì130 ms**  
- Trino –º–µ–¥–ª–µ–Ω–Ω–µ–µ PostgreSQL –ø—Ä–∏–º–µ—Ä–Ω–æ **–≤ 50‚Äì60 —Ä–∞–∑** –Ω–∞ point‚Äëlookup.

---

# 2. Query Benchmark (10 queries)

## 5M rows ‚Äî PostgreSQL (Avg, ms)

| Query | Avg (ms) |
|-------|----------|
| 1 | 11.89 |
| 2 | 2.46 |
| 3 | 1.60 |
| 4 | 5080 |
| 5 | 2.58 |
| 6 | 2.17 |
| 7 | 4751 |
| 8 | 4400 |
| 9 | 4419 |
| 10 | 2.25 |

## 10M rows ‚Äî PostgreSQL (Avg, ms)

| Query | Avg (ms) |
|-------|----------|
| 1 | 13.42 |
| 2 | 2.81 |
| 3 | 1.95 |
| 4 | 9242 |
| 5 | 1.96 |
| 6 | 1.72 |
| 7 | 9108 |
| 8 | 8439 |
| 9 | 8800 |
| 10 | 2.10 |

## 5‚Äì11M rows ‚Äî Trino (Avg, ms)

### Round 1 (5M rows)

| Query | Avg (ms) |
|-------|----------|
| 1 | 98.32 |
| 2 | 164.13 |
| 3 | 140.33 |
| 4 | 6806 |
| 5 | 121.91 |
| 6 | 125.66 |
| 7 | 7019 |
| 8 | 6557 |
| 9 | 6717 |
| 10 | 168.00 |

### Round 2 (11M rows)

| Query | Avg (ms) |
|-------|----------|
| 1 | 91.31 |
| 2 | 139.55 |
| 3 | 123.65 |
| 4 | 9710 |
| 5 | 117.86 |
| 6 | 117.41 |
| 7 | 9742 |
| 8 | 9411 |
| 9 | 9216 |
| 10 | 112.94 |

---

# 3. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ PostgreSQL vs Trino –ø–æ –∫–∞–∂–¥–æ–º—É —Ç–∏–ø—É –∑–∞–ø—Ä–æ—Å–∞

## Point‚Äëlookup (queries 1‚Äì3, 5‚Äì6, 10)

| Query | PostgreSQL Avg (ms) | Trino Avg (ms) | Ratio |
|-------|----------------------|----------------|--------|
| 1 | 13 | 91‚Äì98 | **7√ó slower** |
| 2 | 2.8 | 140‚Äì164 | **50√ó slower** |
| 3 | 1.9 | 123‚Äì140 | **60√ó slower** |
| 5 | 2.0 | 118‚Äì122 | **60√ó slower** |
| 6 | 1.7 | 117‚Äì126 | **70√ó slower** |
| 10 | 2.1 | 112‚Äì168 | **50‚Äì80√ó slower** |

## Heavy scans / GROUP BY (queries 4, 7‚Äì9)

| Query | PostgreSQL Avg (ms) | Trino Avg (ms) | Ratio |
|-------|----------------------|----------------|--------|
| 4 | 9242 | 6806‚Äì9710 | **‚âà same** |
| 7 | 9108 | 7019‚Äì9742 | **‚âà same** |
| 8 | 8439 | 6557‚Äì9411 | **‚âà same** |
| 9 | 8800 | 6717‚Äì9216 | **‚âà same** |

### –í—ã–≤–æ–¥—ã –ø–æ –∑–∞–ø—Ä–æ—Å–∞–º
- Trino **–∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏ –º–µ–¥–ª–µ–Ω–Ω–µ–µ** PostgreSQL –Ω–∞ —Ç–æ—á–µ—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö (–¥–æ √ó80).  
- –ù–∞ —Ç—è–∂—ë–ª—ã—Ö —Å–∫–∞–Ω–∞—Ö Trino ‚âà PostgreSQL (–∏–Ω–æ–≥–¥–∞ —á—É—Ç—å –±—ã—Å—Ç—Ä–µ–µ, –∏–Ω–æ–≥–¥–∞ —á—É—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ).  
- –≠—Ç–æ –æ–∂–∏–¥–∞–µ–º–æ: Trino –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ **–∞–Ω–∞–ª–∏—Ç–∏–∫—É**, –∞ –Ω–µ –ø–æ–¥ **OLTP‚Äë–¥–æ—Å—Ç—É–ø –ø–æ –∏–Ω–¥–µ–∫—Å—É**.

---

# 4. –û–±—â–∏–µ –≤—ã–≤–æ–¥—ã

## PostgreSQL (idx)
- –õ—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è point‚Äëlookup.  
- –õ–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å 2‚Äì3 ms.  
- –¢—è–∂—ë–ª—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∑–∞–Ω–∏–º–∞—é—Ç 8‚Äì9 —Å–µ–∫—É–Ω–¥.

## Trino (idx)
- Point‚Äëlookup: **120‚Äì160 ms** (–≤ 50‚Äì80 —Ä–∞–∑ –º–µ–¥–ª–µ–Ω–Ω–µ–µ).  
- –¢—è–∂—ë–ª—ã–µ –∑–∞–ø—Ä–æ—Å—ã: **6‚Äì10 —Å–µ–∫—É–Ω–¥**, –ø—Ä–∏–º–µ—Ä–Ω–æ –∫–∞–∫ PostgreSQL.  
- –û—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏, –ø–ª–æ—Ö–æ ‚Äî –¥–ª—è OLTP.

---

# 5. –§–∏–Ω–∞–ª—å–Ω–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

### –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å—ã –≤–∏–¥–∞:
- ¬´–ø–æ–ª—É—á–∏—Ç—å –∑–∞–ø–∏—Å–∏ –ø–æ –ø—Ä–æ—Ñ–∏–ª—é¬ª  
- ¬´–ø–∞–≥–∏–Ω–∞—Ü–∏—è –ø–æ –ø—Ä–æ—Ñ–∏–ª—é¬ª  
- ¬´–ø–æ–ª—É—á–∏—Ç—å –∑–∞–ø–∏—Å—å –ø–æ id¬ª  

‚Üí **–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PostgreSQL –Ω–∞–ø—Ä—è–º—É—é**, Trino –∑–¥–µ—Å—å –Ω–µ–ø—Ä–∏–≥–æ–¥–µ–Ω.

### –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å—ã:
- –±–æ–ª—å—à–∏–µ –≤—ã–±–æ—Ä–∫–∏,  
- –∞–≥—Ä–µ–≥–∞—Ü–∏–∏,  
- –∞–Ω–∞–ª–∏—Ç–∏–∫–∞,  
- –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤  

‚Üí **Trino –ø–æ–¥—Ö–æ–¥–∏—Ç**, –Ω–æ –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç PostgreSQL.

---

# 6. –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

| –¢–∏–ø –Ω–∞–≥—Ä—É–∑–∫–∏ | PostgreSQL | Trino |
|--------------|------------|--------|
| Point‚Äëlookup | **2 ms** | **120‚Äì160 ms** |
| Aggregations | 8‚Äì9 s | 6‚Äì10 s |
| OLTP | ‚úî | ‚úò |
| OLAP | ‚úî (–º–µ–¥–ª–µ–Ω–Ω–µ–µ) | ‚úî (–ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ) |
| Federated queries | ‚úò | ‚úî |

---



